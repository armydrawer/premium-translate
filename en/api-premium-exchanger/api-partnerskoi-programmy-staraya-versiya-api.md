# API партнерской программы (старая версия API)

{% hint style="info" %}
API партнерской программы работает только со включенными модулями "**API**" и "**Партнерская программа API**"
{% endhint %}

Активируем модули:

<figure><img src="../.gitbook/assets/изображение (173).png" alt=""><figcaption></figcaption></figure>

После активации модуля перейдите в раздел "**Пользователи**" -> выберите пользователя ("**Редактировать**"), для которого будет включен доступ к API и активируйте следующие параметры:\


<figure><img src="../.gitbook/assets/изображение (151).png" alt=""><figcaption></figcaption></figure>

После этого перейдите в раздел "**Партнерская программа**" - "**Настройки**" и активируйте API в этом разделе:\


<figure><img src="../.gitbook/assets/изображение (85).png" alt=""><figcaption></figcaption></figure>

## Как узнать, что модуль активен и где взять ключ?

Если модуль активирован, то на странице партнерского кабинета (обычно это страница `https://ваш_домен/paccount/)` в информационном блоке будет отображаться строка Rest API ключ, на которой вы можете посмотреть свой личный ключ (**api\_key**).

<figure><img src="../.gitbook/assets/image (1041).png" alt=""><figcaption></figcaption></figure>

При необходимости вы можете сгенерировать новый ключ, нажав на ссылку "**Изменить REST API ключ**" - через пару секунд в поле "**REST API ключ**" будет отображаться новый ключ, старый ключ при этом перестаёт работать.

Точка входа: `https://ваш_домен/api.html`

## Данные, передаваемые GET параметрами:

**api\_action** – pp (именно это действие использует модуль ppapi)\
**api\_key** – выпущенный ключ\
**method** – метод API модуля

Ссылку на API также можно получить, нажав на ссылку в ЛК партнерского кабинета Rest API key, она уже будет содержать ваш ключ и будет выглядеть следующим образом:

**`https://siteurl/api.html?api_action=pp&api_key={api_key}&method={method}`**

## Методы работы с API:

### <mark style="color:blue;">get\_info</mark>

Информация о партнере

Параметры запроса:

```
---
```

```
balance — баланс вашего аккаунта
min_payout — минимальная сумма для выплаты
items — доступные элементы
id — id метода выплаты
title — название метода
comission — комиссия, которая будет вычтена при выплате
amount — сумма, которую вы получаете
```

### <mark style="color:blue;">get\_links</mark>

Информация о партнерских переходах

Параметры запроса:

```
start_time - unix-время с которого выводить (фильтр, необязательный параметр)
end_time - unix-время до которого выводить (фильтр, необязательный параметр)
ip - ip-адрес (фильтр, необязательный параметр)
```

Ответ:

```
items — доступные элементы
id — id ссылки
time — unix-время
date — дата и время
browser — браузер
ip — ip-адрес
referrer — REFERRER перехода по ссылки
user_hash — уникальный хэш посетителя на сайте
query_string — запрос в строке браузера (get-параметры)
```

### <mark style="color:blue;">get\_exchanges</mark>

Информация о партнерских обменах

Параметры запроса:

```
start_time - unix-время, с которого выводить заявки (фильтр, необязательный параметр)
end_time - unix-время, до которого выводить заявки (фильтр, необязательный параметр)
```

Ответ:

```
items — доступные элементы
id — id выплаты
time — время в unix
date — дата и время
currency_code_give — код валюты отдаю
currency_code_get — код валюты получаю
course_give — курс отдаю
course_get — курс получаю
amount_give — сумма отдаю
amount_get — сумма получаю
exchange_success — статус заявки (0- не выполненная, 1-выполненная)
accrued — начисление партнерского вознаграждения (0- не насчитано, 1 — насчитано)
partner_reward — сумма партнерского вознаграждения
user_hash — уникальный хэш посетителя на сайте
statuses — хронология смены статусов заявки, если подключен модуль логирования статусов. Выводятся статусы: новая заявка, отмеченая как оплачена, оплаченная, выполненная заявка.
```

### <mark style="color:blue;">get\_payouts</mark>

Список запросов от пользователей на вывод денежных средств

Параметры запроса:

```
start_time - unix-время с которого выводить (фильтр, необязательный параметр)
end_time - unix-время до которого выводить (фильтр, необязательный параметр)
```

Ответ:

```
items — доступные элементы
id — id выплаты
time — unix-время
date — дата и время
method_id — метод выплаты (посмотреть можно в get_info)
account — счет на который заказана выплата
pay_amount — сумма выплаты
pay_currency_code — код валюты суммы выплаты
original_amount — сумма выплаты (оригинальная)
original_currency_code — код валюты суммы выплаты (оригинальная)
status — статус заявки выплаты (0 — в ожидании, 1 — выполнено, 2 — отменена, 3 — отменено пользователем)
```

### <mark style="color:blue;">add\_payout</mark>

Создание запроса на выплату

параметры запроса:

```
method_id — метод выплаты (посмотреть можно в get_info)
account — номер счета, для выплаты
```

ответ:

```
payout_id - id выплаты
```
