# Evo Pay

{% hint style="info" %}
Если вам необходимо обновить модуль на сервере — воспользуйтесь [инструкцией](https://premium.gitbook.io/main/osnovnye-nastroiki/faq/obnovlenie-failov-skripta-na-servere/kak-obnovit-faily-na-servere#moduli-merchantov-i-avtovyplat)
{% endhint %}

## Настройки в личном кабинете мерчанта

{% hint style="warning" %}
Для обсуждения условий и подключения свяжитесь с представителем сервиса ([https://t.me/evopayceo](https://t.me/evopayceo) или [https://t.me/tethermckenna](https://t.me/tethermckenna)).

**Дисклеймер**: при подключении вашего сайта к тому или иному сервису оценивайте, пожалуйста, самостоятельно возможные риски сотрудничества.
{% endhint %}

Авторизуйтесь в [личном кабинете EVO](https://evo-pay.net/login). Перейдите в раздел "**Settings**" и создайте API ключ по кнопке "**Create API KEY**".

<figure><img src="../../../.gitbook/assets/image (110).png" alt=""><figcaption></figcaption></figure>

Скопируйте сгенерированный ключ (без `API KEY:`) в буфер обмена или текстовый файл.

<figure><img src="../../../.gitbook/assets/image (114).png" alt="" width="324"><figcaption></figcaption></figure>

Перейдите в настройки модуля в админ-панели Premium Exchanger.

Для работы вебхука изменения статуса заявок укажите URL из настроек модуля мерчанта в ЛК EVO. Дополнительно добавьте в вайтлист вашего файрвола все IP-адреса мерчанта, с которых они отправляют вебхуки (список IP-адресов запрашивайте напрямую у мерчанта).

<figure><img src="../../../.gitbook/assets/image (115).png" alt=""><figcaption></figcaption></figure>

Для обновления статусов заявок без использования задания Cron добавьте вебхук в ЛК EVO, выберите метод "**Order**" и вставьте скопированный ранее URL для вебхука. Сохраните изменения.

<figure><img src="../../../.gitbook/assets/image (2178).png" alt=""><figcaption></figcaption></figure>

## Настройки модуля

В панели администратора создайте нового мерчанта в разделе "**Мерчанты**" ➔ "**Добавить мерчант".**

Выберите Evo в выпадающем списке в поле "**Модуль**", укажите название для модуля и нажмите "**Сохранить**".

<figure><img src="../../../.gitbook/assets/image (117).png" alt="" width="422"><figcaption></figcaption></figure>

Заполните указанные авторизационные поля.

<figure><img src="../../../.gitbook/assets/image (116).png" alt="" width="424"><figcaption></figcaption></figure>

**Домен** — оставьте поле пустым

**API ключ** — API ключ, скопированный ранее в ЛК мерчанта

## Особые поля

<figure><img src="../../../.gitbook/assets/image (118).png" alt="" width="455"><figcaption></figcaption></figure>

**Способ оплаты** — выберите подходящий способ для приема средств от клиента (по умолчанию доступны 2 метода: `BANK_CARD` — для получения реквизитов банковских карт и `SBP` — для получения номера телефона для пополнения через СБП).

<figure><img src="../../../.gitbook/assets/image (119).png" alt="" width="318"><figcaption></figcaption></figure>

При выборе пункта "**Все**" мерчантом будут выдаваться любые доступные реквизиты, вне зависимости от метода.

**Добавить** — добавление собственных способов оплаты (не используется без инструкции от мерчанта)

{% hint style="warning" %}
Для каждого используемого способа оплаты необходимо создать отдельную копию модуля мерчанта, в которой выбрать соответствующий способ, а затем подключить эту копию на вкладке "**Мерчанты и выплаты**" в настройках направления обмена, где в валюте "**Отдаю**" будет подходящая валюта
{% endhint %}

**Пересчет заявки, если сумма платежа изменилась** — опция, работающая по аналогии с [основной опцией пересчета суммы по заявке](https://premium.gitbook.io/main/osnovnye-nastroiki/valyuty-i-napravleniya-obmena/sozdanie-novogo-napravleniya#pereschet-po-summe-oplaty).

{% hint style="warning" %}
Если заявка указана на сумму 5000 рублей, мерчант может потребовать внесение суммы в пределах 4999.50–5000.50 рублей (возможное отклонение — до 100 рублей). При этом мерчант может как потребовать отличающуюся сумму, так и принять указанную изначально.

Таким образом, если клиенту отображается сумма в 5000 рублей, мерчант может не зафиксировать платеж автоматически, если фактически внесённая сумма будет незначительно отличаться (на несколько рублей или копеек).

Новая опция интегрируется с модулем пересчета заявок. При соблюдении необходимых условий и обнаружении расхождения в суммах будет автоматически запущен процесс пересчета.

Новая сумма и пересчёт осуществляются на основании выбранного значения в параметре "**Сумма, ожидаемая к зачислению**".

![](<../../../.gitbook/assets/image (112).png>)

Если функция пересчёта в настройках мерчанта включена, система автоматически обработает расхождение, дополнительное вмешательство не требуется.

Однако, если пересчёт отключён, новая сумма будет записана в соответствующее поле. В этом случае необходимо отображать клиенту именно это поле, чтобы он видел актуальную сумму для перевода. В противном случае клиент увидит сумму, указанную в заявке, что зависит от используемого шорткода.
{% endhint %}

**Статус работы** — отображается статус подключения модуля ("<mark style="color:green;">**ОК**</mark>" - модуль подключен, "<mark style="color:red;">**ОШИБКА**</mark>" - ошибка при авторизации в модуле, требуется указать валидный API-ключ)

## Продолжение настройки

Далее произведите настройку мерчанта следуя [общей инструкции по настройке](https://premium.gitbook.io/rukovodstvo-polzovatelya/osnovnye-nastroiki/merchanty-i-avtovyplaty/merchanty/obshie-nastroiki-merchantov).\
