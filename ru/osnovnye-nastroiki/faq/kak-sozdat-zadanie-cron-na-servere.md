---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
  metadata:
    visible: true
---

# Как создать задание Cron на сервере?

{% hint style="info" %}
Задания cron создаются на сервере для выполнения регулярных задач. К примеру, проверка статуса платежа, обновление курсов валют для парсера и так далее.
{% endhint %}

Если вы используете панель управления сервером ISP Manager - то выполните следующие шаги:

1. Скопируйте в буфер обмена ссылку cron из того раздела, для которого вы хотите настроить автоматические действия (проверка платежей, парсинг курсов и т.п.).
2. В панели ISP Manager перейдите в раздел "**Планировщик CRON**" и нажмите на кнопку "**Создать задание**":

{% hint style="danger" %}
Все задания cron должны быть созданы из-под пользователя, созданного для сайта **(не из-под root-пользователя)**
{% endhint %}

<figure><img src="../../.gitbook/assets/изображение (124).png" alt="" width="563"><figcaption></figcaption></figure>

3. На новой странице заполните данные для задания cron:

<figure><img src="../../.gitbook/assets/image (1310) (1).png" alt="" width="473"><figcaption></figcaption></figure>

**Адрес e-mail** — укажите почтовый ящик, на который будут приходить письма об ошибках выполнения задания (опция работает только, если настроена исходящая почта в ISP Manager в разделе "**Настройки** -> **Оповещения**")

**Команда** — полная команда для выполнения (пример ниже)

**Описание** — тестовое описание для задания (необязательное к заполнению поле)

**Галочка "Включено"** — статус задания

**Расписание** — выберите "экспертный режим" и установите во всех появившихся ниже полях "\*" (астериск, звездочка) для ежеминутного выполнения задания

{% hint style="success" %}
Обратите внимание, что вы можете запускать задание чаще чем раз в минуту. Для этого потребуется создать второе задание с той же ссылкой и добавить команду **sleep \[секунды]**, чтобы задание запускалось с указанной отсрочкой от первого задания.

К примеру, если исходное задание для парсера, к примеру, выглядит как **`/usr/bin/wget -t 1 -O - --no-check-certificate "https://site.com/cron-bestchangeapi_upload_data.html`** , второе задание будет выглядеть как **`sleep 30 && /usr/bin/wget -t 1 -O - --no-check-certificate "https://site.com/cron-bestchangeapi_upload_data.html` .**

При таких настройках парсер будет получать курсы от Bestchange 2 раза в минуту.

Вы можете создать и третье задание с sleep 40 (в этом случае во втором задании cron стоит указать sleep 20), чтобы задание выполнялось 3 раза в минуту, но мы не рекомендуем так делать, так как сам сервис может не успевать отдавать запрашиваемые данные за 20 секунд и вы будете получать ошибки.
{% endhint %}

**Галочка "Не отправлять отчет на e-mail"** - снимите галочку для того, чтобы письма о выполнении и ошибках выполнения задания приходили на вашу почту

{% hint style="warning" %}
Обратите внимание, что для каждого сервера команда из примера может иметь другой вид, но в большинстве случае достаточно указанного ниже формата.

**`/usr/bin/wget -t 1 -O - --no-check-certificate "ваш_URL"`**

Если ваш URL — **`https://site.com/cron-bestchangeapi_upload_data.html`**

то задание должно иметь вид **`/usr/bin/wget -t 1 -O - --no-check-certificate "https://site.com/cron-bestchangeapi_upload_data.html"`**

Ссылки для заданий cron находятся в соответствующих разделах (несколько примеров):

* Парсеры 2.0 — Настройки

<img src="../../.gitbook/assets/image (1944).png" alt="" data-size="original">

* Bestchange парсер - Настройки

<img src="../../.gitbook/assets/image (1945).png" alt="" data-size="original">

* модуля мерчантов и автовыплат

<img src="../../.gitbook/assets/image (1946).png" alt="" data-size="original">
{% endhint %}
