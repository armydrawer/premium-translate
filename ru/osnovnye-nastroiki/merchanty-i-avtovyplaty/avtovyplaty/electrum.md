# Electrum

{% hint style="danger" %}
<mark style="color:red;">Перед настройкой автовыплат обязательно прочитайте</mark> [<mark style="color:blue;">предупреждение о рисках</mark>](https://premium.gitbook.io/main/osnovnye-nastroiki/merchanty-i-avtovyplaty/avtovyplaty/preduprezhdenie-o-riskakh)<mark style="color:blue;">!</mark>
{% endhint %}

{% hint style="info" %}
Если вам необходимо обновить модуль на сервере — воспользуйтесь [инструкцией](https://premium.gitbook.io/rukovodstvo-polzovatelya/osnovnye-nastroiki/faq/kak-obnovit-faily-na-servere#moduli-avtovyplat)
{% endhint %}

{% hint style="warning" %}
На прием средств и для автовыплаты **рекомендуется** использовать [разные Electrum-кошельки](https://premium.gitbook.io/rukovodstvo-polzovatelya/osnovnye-nastroiki/modul-electrum/ustanovka-i-nastroika-electrum/sozdanie-dopolnitelnogo-koshelka)
{% endhint %}

## Установка и настройка модуля

Выполните установку Electrum на сервер по [инструкции](https://premium.gitbook.io/rukovodstvo-polzovatelya/osnovnye-nastroiki/modul-electrum/ustanovka-i-nastroika-electrum).

Обязательно сохраните в текстовый файл пароль от кошелька, номер порта для подключения, адрес сервера (опционально), логин и пароль для подключения кошелька.

<figure><img src="../../../.gitbook/assets/image (1443).png" alt=""><figcaption></figcaption></figure>

## **Настройки модуля**

В панели администратора создайте нового мерчанта в разделе "**Автовыплаты**" -> "**Добавить автовыплату".**

Выберите Electrum в выпадающем списке в поле "**Модуль**", укажите название для модуля и нажмите "**Сохранить**".

<figure><img src="../../../.gitbook/assets/image (1447).png" alt="" width="509"><figcaption></figcaption></figure>

Заполните указанные авторизационные поля.

<figure><img src="../../../.gitbook/assets/image (1448).png" alt=""><figcaption></figcaption></figure>

* **Количество подтверждения платежа, чтобы считать его выполненным** — оставьте поле пустым для работы со стандартным значением, которое использует Electrum
* **Login** — данные из строки "**Пользователь для подключения**"
* **Password** — данные из строки "**Пароль пользователя для подключения**"
* **Api server** — данные из строки "**API сервер**"&#x20;

{% hint style="warning" %}
Поле "**API Server**" заполняется только если модуль Electrum установлен на сервер, отличный от того, где установлен скрипт Premium Exchanger.

Если модуль Electrum установлен на одном сервере со скриптом Premium Exchanger — оставьте поле пустым.
{% endhint %}

* **Api port** — данные из строки "**Порт для подключения**"
* **Wallet password** — пароль от вашего кошелька, заданный при создании кошелька (если пароль не был задан — оставьте поле пустым)

## Особые поля

В настройках модуля автовыплат находится следующие настройки:

<figure><img src="../../../.gitbook/assets/image (768).png" alt=""><figcaption></figcaption></figure>

1. Массовые выплаты:

* “**Нет**” — массовые выплаты не используются и заявки будут выплачиваться поочередно.
* “**Да + моментальная выплата по кнопке**” — будет включена массовая выплата заявок, а также можно совершить моментальную единичную выплату заявки по кнопке “Перевести” в разделе "Заявки" в панели администратора.
* “**Да + добавление заявки в очередь на выплату**” — будет включена массовая выплата заявок, а при нажатии кнопку “Перевести” в разделе "Заявки" в панели администратора заявки будут попадать в очередь на массовую выплату.

2. Приоритет комиссии — выберите один из доступных вариантов комиссии сети.

{% hint style="info" %}
Размер актуальной комиссии для отправки платежа автоматически запрашивается в сервисе [Mempool.space](https://mempool.space/api/v1/fees/recommended) непосредственно перед каждой выплатой средств.
{% endhint %}

3. **Минимальный и максимальный размер комиссии (в байтах)** — ограничения для минимального и максимального размера комиссии сети. Рекомендуем обязательно установить таковые, чтобы избежать использования аномальных значений.

&#x20;        _Рекомендованное значения для мин. = 3 и для макс. = 100_.

4. **Мин кол-во заявок для массовой выплаты** — минимальное кол-во заявок в очереди, при котором будет срабатывать массовая выплата. Если нужного количества не окажется в очереди, то выплата не сработает.

&#x20;        _Рекомендованное значение = 20_.

5. **Время ожидания перед массовой выплатой (в минутах)** — время, в течение которого будут копиться оплаченные заявки перед массовой выплатой. Отcчет времени идет от первой оплаченной заявки в очереди.

&#x20;        _Рекомендованное значение = 5_.

6. **CRON (mass payments)** —  ссылка для задания cron, которую нужно [добавить в планировщик задач на сервере](https://premium.gitbook.io/rukovodstvo-polzovatelya/osnovnye-nastroiki/faq/kak-sozdat-zadanie-cron-na-servere). Данная задача проверяет наличие доступных заявок для выплаты и запускает выплату, если таковые заявки есть.

&#x20;        _Рекомендованное время запуска - раз в 1 минуту_.

### Рекомендованные настройки описанных выше параметров:

<figure><img src="../../../.gitbook/assets/image (1449).png" alt=""><figcaption></figcaption></figure>

При таких настройках массовая выплата будет совершаться через 5 минут, если наберется 20 оплаченных заявок. Если 5 минут истечет, но не будет набрано 20 заявок, то массовая выплата всё равно сработает, но уже с тем количеством заявок, которое будет находится в очереди.

## Продолжение настройки

Далее произведите настройку мерчанта следуя [общей инструкции по настройке](https://premium.gitbook.io/rukovodstvo-polzovatelya/osnovnye-nastroiki/merchanty-i-avtovyplaty/avtovyplaty/obshie-nastroiki-merchantov-avtovyplat).
