# Finora



{% hint style="danger" %}
Перед настройкой автовыплат обязательно прочитайте [предупреждение о рисках!](https://premium.gitbook.io/main/osnovnye-nastroiki/merchanty-i-avtovyplaty/avtovyplaty/preduprezhdenie-o-riskakh)
{% endhint %}

{% hint style="info" %}
Если вам необходимо обновить модуль на сервере — воспользуйтесь [инструкцией](https://premium.gitbook.io/main/osnovnye-nastroiki/faq/obnovlenie-failov-skripta-na-servere/kak-obnovit-faily-na-servere#moduli-merchantov-i-avtovyplat)

<mark style="color:red;">Обратите внимание, что при обновлении модуля необходимо настроить его повторно по инструкции ниже, так как после обновления файлов все поля и настройки модуля будут сброшены к состоянию по умолчанию.</mark>
{% endhint %}

{% hint style="warning" %}
Для обсуждения условий и подключения свяжитесь с представителем сервиса.

**Дисклеймер**: при подключении вашего сайта к тому или иному сервису, пожалуйста, самостоятельно оценивайте возможные риски сотрудничества.
{% endhint %}

{% hint style="warning" %}
Обращаем ваше внимание, что при использовании модуля автовыплаты Finora фактическая сумма выплаты всегда округляется до двух знаков после запятой на стороне сервиса.
{% endhint %}

## Настройки модуля

В панели администратора создайте нового мерчанта в разделе "**Мерчанты**" ➔ "**Добавить автовыплату".**

Выберите Finora в выпадающем списке в поле "**Модуль**", укажите название для модуля и нажмите "**Сохранить**".

<figure><img src="../../../.gitbook/assets/изображение (2) (1) (1) (1) (1).png" alt="" width="378"><figcaption></figcaption></figure>

Заполните указанные авторизационные поля.

<figure><img src="../../../.gitbook/assets/изображение (2) (1) (1) (1) (1) (1).png" alt="" width="409"><figcaption></figcaption></figure>

**Логин (ЛК)** — логин от вашего ЛК в Finora

**OTP ключ (ЛК)** — OTP-ключ, выданный вам менеджером Finora

**Логин (SSO выплата)** — логин, выданный вам менеджером Finora

**OTP ключ (SSO выплата)** — OTP-ключ, выданный вам менеджером Finora

**Приватный ключ** — приватный ключ, из вашего ЛК в Finora (выпускается по инструкции ниже)

{% hint style="warning" %}
Перед началом работы вам нужно сгенерировать публичный ключ (**Public key**), который следует сохранить в ЛК платежной системы (**Security - Your Public Key**), а приватный ключ (**Private key**) в настройках модуля в поле "**Приватный ключ**"

![](<../../../.gitbook/assets/изображение (198).png>)

Для удобства работы пара ключей автоматически генерируется для работы с мерчантом (для корректной работы генератора ключей на сервере должна быть запущена служба/расширение **Sodium**). Скопируйте эти ключи из настроек модуля автовыплаты и вставьте их в соответствующие поля согласно инструкции выше.

![](<../../../.gitbook/assets/изображение (194).png>)
{% endhint %}

## Особые поля

<figure><img src="../../../.gitbook/assets/изображение (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Способ оплаты** — выберите подходящий метод из списка

{% hint style="info" %}
## Дополнительные поля для заявки

Для корректной передачи данных получателя в платежную систему необходимо добавить дополнительные поля в направлениях обмена.

Для этого создайте и добавьте дополнительные поля к соответствующим валютам для выплат. Обязательно укажите переменную в поле "Уникальный ID" (в нижнем регистре) и сделайте поле обязательным к заполнению.

**1. Дополнительное поле для ФИО получателя**

* **Уникальный ID:** `get_cardholder/cardholder`

<img src="../../../.gitbook/assets/изображение (7).png" alt="" data-size="original">

* **Назначение:** Полное имя получателя платежа (ФИО)
* **Приоритет обработки:**
  * `get_cardholder` или `cardholder` (приоритетное поле)
  * Автоматическое формирование из персональных данных клиента (ФИО из ПД)

**2. Дополнительное поле для номера карты**

* **Уникальный ID:** `get_account/account`
* **Назначение:** Номер карты получателя
* **Приоритет обработки:**
  * `get_account` или `account` (приоритетное поле)
  * Поле «На счет» из настроек валюты

**3. Дополнительное поле для номера телефона**

* **Уникальный ID:** `get_phone/phone`
* **Назначение:** Номер телефона получателя (обязательно с префиксом "+")
* **Приоритет обработки:**
  * `get_phone` или `phone` (приоритетное поле)
  * Поле «На счет» из настроек валюты

**4. Дополнительное поле для названия банка**

* **Уникальный ID:** `get_bankname/bankname`
* **Назначение:** Название банка получателя (список доступных банков необходимо уточнить в чате поддержки платежной системы)
* **Приоритет обработки:**
  * `get_bankname` или `bankname` (приоритетное поле)
  * Валюта из направления обмена

После добавления этих полей они будут отображаться в форме обмена и станут обязательными для заполнения клиентом при создании заявки на выплату.

**3. Выбор способа оплаты**

В настройках модуля вы можете выбрать, как будут определяться реквизиты для выплаты.

* **Автоматически:** Система сама определит тип реквизитов на основе введенных данных:
  * **Телефон:** если значение начинается с «+» и содержит от 10 до 15 символов.
  * **Карта:** если значение содержит от 12 до 19 символов.
* **Карта:** Принудительно использовать для выплаты значение из полей для номера карты (`get_account/account` или «На счет»).
* **Телефон:** Принудительно использовать для выплаты значение из полей для номера телефона (`get_phone/phone` или «На счет»).
{% endhint %}

Для работы модуля автовыплаты без использования [задания cron](https://premium.gitbook.io/main/osnovnye-nastroiki/faq/kak-sozdat-zadanie-cron-na-servere), укажите ссылку из настроек модуля

<figure><img src="../../../.gitbook/assets/изображение (197).png" alt=""><figcaption></figcaption></figure>

&#x20;в ЛК Finora в поле **PayOut Webhook**:

<figure><img src="../../../.gitbook/assets/изображение (196).png" alt=""><figcaption></figcaption></figure>

## Продолжение настройки <a href="#prodolzhenie-nastroiki" id="prodolzhenie-nastroiki"></a>

Далее произведите настройку мерчанта следуя [общей инструкции по настройке](https://premium.gitbook.io/rukovodstvo-polzovatelya/osnovnye-nastroiki/merchanty-i-avtovyplaty/avtovyplaty/obshie-nastroiki-merchantov-avtovyplat).
